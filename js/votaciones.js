$(document).ready(function(){
    ///////////////////////////////////////////////////////// INICIALIZAR VARIABLES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// INICIALIZAR VARIABLES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// INICIALIZAR VARIABLES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// INICIALIZAR VARIABLES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// INICIALIZAR VARIABLES ////////////////////////////////////////////////////////////////
         $('.modal').modal();
    ///////////////////////////////////////////////////////// EVENTOS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// EVENTOS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// EVENTOS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// EVENTOS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// EVENTOS ////////////////////////////////////////////////////////////////
    $( "#btnVotar" ).click(function() {
        console.log("Boton Votar");
        var sucursal=$('input:radio[name=group1]:checked').val();
        var usuario=Cookies.get('b_capturista_id');
        console.log(sucursal+ "usuario:"+usuario);
        votacion({ opcion : 2,sucursal_id:sucursal,empleado_id:usuario},respInsertarVoto);
        document.getElementById('opcionesVoto').style.display = 'none';
        $('#btnVotar').addClass("disabled");
    });
       
    
    
    });
    
    ///////////////////////////////////////////////////////// RESPUESTAS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// RESPUESTAS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// RESPUESTAS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// RESPUESTAS ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// RESPUESTAS ////////////////////////////////////////////////////////////////
    
    var respVerifVoto = function(data) 
    { 
        if (!data && data == null)
        return;  
        var contador=data[0].conteo;
        console.log("contador:"+contador);

        document.getElementById('opcionesVoto').style.display = 'block';
        $("#btnVotar").removeAttr("disabled");
           
           
       
        
    }

    var respInsertarVoto = function(data) 
    { 
        if (!data && data == null)
        return;  
        
        M.toast({html: 'Voto realizado, Gracias!', classes: 'rounded green'});

        
    }

    var respVerifSucursal = function(data) 
    { 
        if (!data && data == null)
        return;  
        var numero=data[0].numero;
        console.log("Numero: "+numero);
        document.getElementById('r'+numero+"").disabled=true;        
    }
    

    var respResultados = function(data) 
    { 
        if (!data && data == null) 
        return; 

        var d = '';
        var suma=0;
        var x=0;
        console.log("cargando votos resultados");

        for (var i = 0; i < data.length; i++) {
        x=parseInt(data[i].votos);
        suma=suma+x;
        d+= '<tr>'+
        '<td>'+data[i].numero_altar+'</td>'+
        '<td>'+data[i].id_suc+'</td>'+
        '<td>'+data[i].sucursal+'</td>' +
        '<td>'+data[i].votos+'</td>' +
        '</tr> ';
        }
        $('#total_votos').val(suma);
        
        $("#tablaResultados").html(d);

         
    }


    
    ///////////////////////////////////////////////////////// FUNCIONES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// FUNCIONES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// FUNCIONES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// FUNCIONES ////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////// FUNCIONES ////////////////////////////////////////////////////////////////
    function checarVotaciones(){

        console.log("Checar votaciones ");
        cargarMenuPorRol();
        var usuario=Cookies.get('b_capturista_id');
        var sucursal=Cookies.get('b_id_sucursal');
        votacion({ opcion : 3,sucursal_id:sucursal},respVerifSucursal);
        votacion({ opcion : 1,empleado_id:usuario},respVerifVoto);
       
    }
    

    function cargarResultadosVotos(){

        console.log("cargando votos!");
        
        votacion({ opcion : 4},respResultados);
      
       
    }





   